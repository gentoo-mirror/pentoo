Description: add-pe-code-signing-to-backdoor-factory
Origin: upstream, http://secureallthethings.blogspot.fr/2015/12/add-pe-code-signing-to-backdoor-factory.html
Forwarded: not-needed
Last-Update: 2015-12-16
---
This patch header follows DEP-3: http://dep.debian.net/deps/dep3/
--- a/pebin.py
+++ b/pebin.py
@@ -1758,6 +1758,14 @@ class pebin():
 
         self.binary.close()
 
+        if self.ZERO_CERT is True:
+            # cert was removed earlier
+            p = subprocess.Popen(['osslsigncode', '-certs', '/usr/share/backdoor-factory/certs/signingCert.cer', '-key', \
+                                  '/usr/share/backdoor-factory/certs/signingPrivateKey.pem', '-n', 'Security','-in', \
+                                   self.flItms["backdoorfile"], '-out', self.flItms["backdoorfile"], '-pass', 'moomoo'])
+
+            p.wait()
+
         if self.VERBOSE is True:
             self.print_flItms(self.flItms)
 
