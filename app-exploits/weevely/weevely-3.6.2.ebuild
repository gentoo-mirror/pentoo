# Copyright 1999-2018 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2

EAPI=6

PYTHON_COMPAT=( python2_7 )

inherit eutils python-single-r1

DESCRIPTION="Weevely is a stealth PHP web shell that simulate telnet-like console"
HOMEPAGE="https://github.com/epinna/weevely3"
SRC_URI="https://github.com/epinna/weevely3/archive/v${PV}.tar.gz -> ${P}.tar.gz"

LICENSE="GPL-3"
SLOT="0"
KEYWORDS="~x86 ~amd64"
IUSE=""

DEPEND=""
RDEPEND="${DEPEND}
	dev-python/prettytable[${PYTHON_USEDEP}]
	dev-python/mako[${PYTHON_USEDEP}]
	dev-python/pyyaml[${PYTHON_USEDEP}]
	dev-python/python-dateutil[${PYTHON_USEDEP}]
	dev-python/PySocks[${PYTHON_USEDEP}]"

DOCS=( README.md )

S="${WORKDIR}/weevely3-${PV}"

src_install() {
	rm LICENSE

	insinto /usr/share/${PN}
	doins -r "${S}"/*

	python_fix_shebang "${ED}"/usr/share/${PN}

	fperms +x /usr/share/${PN}/${PN}.py
	dosym "${EPREFIX}"/usr/share/${PN}/${PN}.py /usr/bin/${PN}
}
