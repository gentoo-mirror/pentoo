# Copyright 1999-2016 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2
# $Id$

EAPI=5

inherit versionator

AVC=( $(get_version_components) )
MY_PV_YYYY=${AVC[0]}
MY_PV_MM=${AVC[1]}

DESCRIPTION="Archive of packetstorm exploits"
HOMEPAGE="http://packetstormsecurity.net"
IUSE=""

#Use monthly archivers
SRC_URI=""
for MY_M in $(eval echo "{01..$MY_PV_MM}"); do
	SRC_URI="${SRC_URI}  https://dl.packetstormsecurity.net/16${MY_M}-exploits/16${MY_M}-exploits.tgz"
done

LICENSE="HPND"
SLOT="${MY_PV_YYYY}"
RESTRICT="fetch"

KEYWORDS="amd64 x86 arm"

DEPEND=""
RDEPEND="!app-exploits/packetstormexploits:0"

S="${WORKDIR}"

pkg_nofetch() {
	einfo "Upstream's certificate chain is incomplete. Run the following command:"
	einfo "wget \"${SRC_URI}\" --no-check-certificate"
	einfo "and move the file into ${DISTDIR}"
}

src_install() {
	insinto /usr/share/exploits/${PN}/
	doins -r *
}
