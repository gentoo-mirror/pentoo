Re-merged patch by Robert Scheck <robert@fedoraproject.org> for tcpick <= 0.2.1,
which works around the segmentation fault by aborting tcpick.

The patch is originally from Cédric Delfosse <cedric@debian.org> after the report
by Andrea Barisani <andrea@inversepath.com> about the possibility maybe to trigger
remotely the segfault condition in tcpick. It's also a better temporary fix rather
the initial quick fix posted at the tcpick mailing list, which makes tcpick nearly
unusable.

Further information:
 - http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-0048
 - http://sourceforge.net/mailarchive/forum.php?thread_id=9989610&forum_id=37151
 - http://www.securityfocus.com/bid/17665
 - http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=360571

--- tcpick-0.2.1/src/write.c			2005-01-09 00:54:47.000000000 +0100
+++ tcpick-0.2.1/src/write.c.CVE-2006-0048	2006-09-09 23:43:07.000000000 +0200
@@ -241,6 +241,9 @@
 	if( flags.separator && ( out == stdout ) ) /* FIXME: sucks? */
 		color( c_SEPARATOR, stdout, SEPARATOR "\n" );
 
+	if (buflen < 0)
+		buflen = 0;
+
 	switch ( flavour ) {
 	case HEX_ASCII_DUMP:
 		out_xa( out, buf, buflen );
